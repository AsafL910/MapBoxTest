pipeline {
    agent { 
        node {
            label 'docker-agent-alpine'
            }
      }

  stages {
    stage('Checkout') {
      steps {
        checkout scm
      }
    }

    stage('Build Docker Image') {
      steps {
        script {
          dockerImage = docker.build('frontend:${env.BUILD_NUMBER}', '-f Dockerfile .')
        }
      }
    }

    stage('Stash Docker Image') {
      steps {
        stash name: 'docker-image', includes: 'frontend*.tar'
      }
    }
  }

  post {
    success {
      unstash 'docker-image'
    }
  }
}
